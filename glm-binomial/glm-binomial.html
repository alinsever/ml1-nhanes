<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Binomial GLM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="glm-binomial_files/libs/clipboard/clipboard.min.js"></script>
<script src="glm-binomial_files/libs/quarto-html/quarto.js"></script>
<script src="glm-binomial_files/libs/quarto-html/popper.min.js"></script>
<script src="glm-binomial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="glm-binomial_files/libs/quarto-html/anchor.min.js"></script>
<link href="glm-binomial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="glm-binomial_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="glm-binomial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="glm-binomial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="glm-binomial_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#generalized-linear-model-family-binomial" id="toc-generalized-linear-model-family-binomial" class="nav-link active" data-scroll-target="#generalized-linear-model-family-binomial">Generalized Linear Model (family: Binomial)</a>
  <ul>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research questions</a></li>
  <li><a href="#make-outcome-variable-depressed-three-levels-binary" id="toc-make-outcome-variable-depressed-three-levels-binary" class="nav-link" data-scroll-target="#make-outcome-variable-depressed-three-levels-binary">Make outcome variable Depressed (three levels) binary</a></li>
  <li><a href="#visual-inspection-of-variable-depressed_bin" id="toc-visual-inspection-of-variable-depressed_bin" class="nav-link" data-scroll-target="#visual-inspection-of-variable-depressed_bin">Visual inspection of Variable Depressed_bin</a></li>
  <li><a href="#selection-of-variables" id="toc-selection-of-variables" class="nav-link" data-scroll-target="#selection-of-variables">Selection of variables</a></li>
  <li><a href="#handling-of-missings" id="toc-handling-of-missings" class="nav-link" data-scroll-target="#handling-of-missings">Handling of missings</a></li>
  <li><a href="#model-1-full-model" id="toc-model-1-full-model" class="nav-link" data-scroll-target="#model-1-full-model">Model 1: Full model</a>
  <ul class="collapse">
  <li><a href="#checking-for-collinearity" id="toc-checking-for-collinearity" class="nav-link" data-scroll-target="#checking-for-collinearity">Checking for Collinearity</a></li>
  </ul></li>
  <li><a href="#model-2-removing-non-significant-predictors" id="toc-model-2-removing-non-significant-predictors" class="nav-link" data-scroll-target="#model-2-removing-non-significant-predictors">Model 2: Removing non-significant predictors</a></li>
  <li><a href="#model-3-removing-conceptually-collinear-predictor-healthgen" id="toc-model-3-removing-conceptually-collinear-predictor-healthgen" class="nav-link" data-scroll-target="#model-3-removing-conceptually-collinear-predictor-healthgen">Model 3: Removing conceptually collinear predictor (HealthGen)</a>
  <ul class="collapse">
  <li><a href="#anova-comparing-glm-models-2-and-3" id="toc-anova-comparing-glm-models-2-and-3" class="nav-link" data-scroll-target="#anova-comparing-glm-models-2-and-3">ANOVA: comparing GLM models 2 and 3</a></li>
  <li><a href="#akaike-information-criterion-aic" id="toc-akaike-information-criterion-aic" class="nav-link" data-scroll-target="#akaike-information-criterion-aic">Akaike Information Criterion (AIC)</a></li>
  </ul></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">Confusion matrix</a>
  <ul class="collapse">
  <li><a href="#results-of-confusion-matrices" id="toc-results-of-confusion-matrices" class="nav-link" data-scroll-target="#results-of-confusion-matrices">Results of Confusion Matrices</a></li>
  <li><a href="#optimal-classification-threshold" id="toc-optimal-classification-threshold" class="nav-link" data-scroll-target="#optimal-classification-threshold">Optimal classification threshold</a></li>
  </ul></li>
  <li><a href="#note-on-overdispersion" id="toc-note-on-overdispersion" class="nav-link" data-scroll-target="#note-on-overdispersion">Note on Overdispersion</a></li>
  <li><a href="#final-remark-on-model-selection" id="toc-final-remark-on-model-selection" class="nav-link" data-scroll-target="#final-remark-on-model-selection">Final remark on model selection</a></li>
  <li><a href="#research-questions-answered" id="toc-research-questions-answered" class="nav-link" data-scroll-target="#research-questions-answered">Research questions answered</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Binomial GLM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="generalized-linear-model-family-binomial" class="level2">
<h2 class="anchored" data-anchor-id="generalized-linear-model-family-binomial">Generalized Linear Model (family: Binomial)</h2>
<p>Mental health is a key public health concern, and NHANES provides rich data for examining factors linked to depressive symptoms. In this chapter, we use a binomial Generalized Linear Model (GLM) to investigate how demographic, socioeconomic, social, and lifestyle variables relate to depression. The GLM analysis also serves as a foundation for the more flexible modeling approach introduced in Chapter 4.</p>
<section id="research-questions" class="level3">
<h3 class="anchored" data-anchor-id="research-questions">Research questions</h3>
<ol type="1">
<li><p>Which demographic, socioeconomic, social, and lifestyle factors are most strongly associated with depressive symptoms?</p></li>
<li><p>How does removing non-significant or conceptually overlapping predictors influence the model’s fit and interpretability?</p></li>
<li><p>How well does the model discriminate between depressed and non-depressed individuals, and which classification threshold performs best?</p></li>
</ol>
</section>
<section id="make-outcome-variable-depressed-three-levels-binary" class="level3">
<h3 class="anchored" data-anchor-id="make-outcome-variable-depressed-three-levels-binary">Make outcome variable Depressed (three levels) binary</h3>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(nhanes_sub$Depressed)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>nhanes_sub <span class="ot">&lt;-</span> nhanes_sub <span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Depressed_bin =</span> <span class="fu">case_when</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      Depressed <span class="sc">==</span> <span class="st">"None"</span> <span class="sc">~</span> <span class="st">"no"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      Depressed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Several"</span>, <span class="st">"Most"</span>) <span class="sc">~</span> <span class="st">"yes"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Depressed_bin =</span> <span class="fu">factor</span>(Depressed_bin, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"no"</span>, <span class="st">"yes"</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the recode</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(nhanes_sub<span class="sc">$</span>Depressed_bin, <span class="at">useNA =</span> <span class="st">"ifany"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
5246 1427 3327 </code></pre>
</div>
</div>
</section>
<section id="visual-inspection-of-variable-depressed_bin" class="level3">
<h3 class="anchored" data-anchor-id="visual-inspection-of-variable-depressed_bin">Visual inspection of Variable Depressed_bin</h3>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p_sleep_hours <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Depressed_bin, <span class="at">y =</span> SleepHrsNight)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sleep Hours vs Depression"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depressive Symptoms"</span>, <span class="at">y =</span> <span class="st">"Sleep Hours"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>p_sleep_trouble <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> SleepTrouble, <span class="at">fill =</span> Depressed_bin)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sleep Trouble vs Depression"</span>,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sleep Trouble"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>p_sleep_hours <span class="sc">+</span> p_sleep_trouble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="glm-binomial_files/figure-html/Depressed_bin%20Visuals-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p_age <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Depressed_bin, <span class="at">y =</span> Age)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Age vs Depression"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depressive Symptoms"</span>, <span class="at">y =</span> <span class="st">"Age"</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p_poverty <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Depressed_bin, <span class="at">y =</span> Poverty)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Poverty Index vs Depression"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Depressive Symptoms"</span>, <span class="at">y =</span> <span class="st">"Poverty Index"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>p_age <span class="sc">+</span> p_poverty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="glm-binomial_files/figure-html/Depressed_bin%20Visuals-2.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p_health <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> HealthGen, <span class="at">fill =</span> Depressed_bin)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"General Health vs Depression"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"General Health"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">45</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>())</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>p_phys <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(nhanes_sub, <span class="sc">!</span><span class="fu">is.na</span>(Depressed_bin)),</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> PhysActive, <span class="at">fill =</span> Depressed_bin)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Physical Activity vs Depression"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Physical Activity"</span>, <span class="at">y =</span> <span class="st">"Proportion"</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>p_health <span class="sc">+</span> p_phys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="glm-binomial_files/figure-html/Depressed_bin%20Visuals-3.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Gender vs Depressed</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin)), aes(x = Gender, fill = Depressed_bin)) +</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(position = "fill")</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # MaritalStatus vs Depressed</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin)), aes(x = MaritalStatus, fill = Depressed_bin)) +</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(position = "fill") +</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle=45, hjust=1))</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # PhysActive nach MaritalStatus</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin)), </span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#        aes(x = PhysActive, fill = Depressed_bin)) +</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(position = "fill") +</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~ MaritalStatus)</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # BMI vs Depressed</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin)), aes(x = Depressed_bin, y = BMI)) +</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_boxplot()</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># library(ggmosaic)</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin))) +</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_mosaic(aes(x = product(Gender, MaritalStatus), fill = Depressed_bin)) +</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#  theme(axis.text.x = element_text(angle = 45, hjust = 1))</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # SleepTrouble nach Gender</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(filter(nhanes_sub, !is.na(Depressed_bin)), </span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#        aes(x = SleepTrouble, fill = Depressed_bin)) +</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_bar(position = "fill") +</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~ Gender)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="selection-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="selection-of-variables">Selection of variables</h3>
<p>Previous research has shown that depression is often associated with demographic, socioeconomic, social, health, and lifestyle factors. Based on these findings and after visual inspection of the graphs above, the following 9 variables are included in the first model:</p>
<ul>
<li><strong>Demographic</strong>: Age, Gender<br>
</li>
<li><strong>Socioeconomic</strong>: Poverty<br>
</li>
<li><strong>Social</strong>: MaritalStatus<br>
</li>
<li><strong>Health-related</strong>: BMI, HealthGen<br>
</li>
<li><strong>Sleep / Activity</strong>: SleepHrsNight, SleepTrouble, PhysActive</li>
</ul>
<p>These choices are supported by findings in NHANES-based studies, where factors such as poverty, marital status, physical activity, sleep problems, BMI, and general health perception were among the strongest predictors of depression (see e.g.&nbsp;Zhang et al., <em>BMC Medical Informatics and Decision Making</em>, 2025).</p>
</section>
<section id="handling-of-missings" class="level3">
<h3 class="anchored" data-anchor-id="handling-of-missings">Handling of missings</h3>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Depressed_data_imp <span class="ot">&lt;-</span> Depressed_data <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">Poverty =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Poverty), <span class="fu">median</span>(Poverty, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), Poverty),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">BMI =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(BMI), <span class="fu">median</span>(BMI, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), BMI),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">SleepHrsNight =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(SleepHrsNight), <span class="fu">median</span>(SleepHrsNight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), SleepHrsNight),)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Depressed_data_imp %&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(all_of(vars_model)) %&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   summarise(across(everything(), ~ sum(is.na(.)))) %&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   pivot_longer(cols = everything(),</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                       names_to = "Variable", values_to = "Missing_Count")</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(Depressed_data_imp, <span class="st">"depressed_imp.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There were missing values in <code>Poverty</code> (443), <code>MaritalStatus</code> (236), <code>BMI</code> (51), and <code>SleepHrsNight</code> (13), while all other variables were complete. Missing values in <code>Poverty</code>, <code>BMI</code>, and <code>SleepHrsNight</code> were imputed using the median, whereas no suitable imputation strategy was identified for <code>MaritalStatus</code>.</p>
</section>
<section id="model-1-full-model" class="level3">
<h3 class="anchored" data-anchor-id="model-1-full-model">Model 1: Full model</h3>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>glm_depressed_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Depressed_bin <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> Poverty <span class="sc">+</span> MaritalStatus <span class="sc">+</span> BMI <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                   HealthGen <span class="sc">+</span> SleepHrsNight <span class="sc">+</span> SleepTrouble <span class="sc">+</span> PhysActive,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> Depressed_data_imp,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> binomial)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(glm_depressed_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                              Estimate  Std. Error    z value     Pr(&gt;|z|)
(Intercept)               -0.473197366 0.296881172 -1.5938948 1.109596e-01
Age                       -0.003897117 0.002389676 -1.6308144 1.029295e-01
Gendermale                -0.347699656 0.066423407 -5.2345953 1.653467e-07
Poverty                   -0.136016413 0.022353030 -6.0849205 1.165491e-09
MaritalStatusLivePartner  -0.017999428 0.140709977 -0.1279186 8.982134e-01
MaritalStatusMarried      -0.704407300 0.104619742 -6.7330246 1.661719e-11
MaritalStatusNeverMarried -0.111505188 0.122639751 -0.9092092 3.632397e-01
MaritalStatusSeparated     0.242312064 0.199402502  1.2151907 2.242934e-01
MaritalStatusWidowed      -0.493927796 0.160353837 -3.0802368 2.068360e-03
BMI                       -0.001855516 0.004780195 -0.3881674 6.978922e-01
HealthGenVgood             0.549908554 0.145097397  3.7899271 1.506915e-04
HealthGenGood              0.793116693 0.142092759  5.5816827 2.382027e-08
HealthGenFair              1.336609984 0.154655776  8.6424835 5.500411e-18
HealthGenPoor              2.023789172 0.214572248  9.4317378 4.033502e-21
SleepHrsNight             -0.082639640 0.024083882 -3.4313255 6.006394e-04
SleepTroubleYes            0.774251048 0.070596501 10.9672723 5.490379e-28
PhysActiveYes             -0.250911668 0.069778166 -3.5958479 3.233367e-04</code></pre>
</div>
</div>
<p>There is <strong>strong evidence against the null hypothesis</strong> that <code>Gender</code>, <code>Poverty</code>, <code>MaritalStatus</code>, <code>HealthGen</code>, <code>SleepHrsNight</code>, <code>SleepTrouble</code> and <code>PhysActivitie</code> have no effect. Whereas <code>Age</code> and <code>BMI</code> show <strong>no significant effect</strong> on Depressed_bin.</p>
<p><strong>Interpretation example</strong>: For individuals who are married, the log-odds of being depressed are 0.70 lower compared to the reference group (estimate = –0.704). Exponentiating the coefficient indicates that being married is associated with roughly a 50% reduction in the odds of depression (OR ≈ 0.49), providing strong evidence against the null hypothesis that marital status has no effect.</p>
<section id="checking-for-collinearity" class="level4">
<h4 class="anchored" data-anchor-id="checking-for-collinearity">Checking for Collinearity</h4>
<p>I am concerned about potential collinearity between the predictors, as this could hinder a proper interpretation of their individual effects. Therefore, I checked the model for signs of collinearity.</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">vif</span>(glm_depressed_1)[ , <span class="st">"GVIF^(1/(2*Df))"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.260333</code></pre>
</div>
</div>
<p>All VIF values are &lt;2, meaning the model does not suffer from collinearity.</p>
</section>
</section>
<section id="model-2-removing-non-significant-predictors" class="level3">
<h3 class="anchored" data-anchor-id="model-2-removing-non-significant-predictors">Model 2: Removing non-significant predictors</h3>
<details>
<summary>
Show output
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>glm_depressed_2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Depressed_bin <span class="sc">~</span> Gender <span class="sc">+</span> Poverty <span class="sc">+</span> MaritalStatus <span class="sc">+</span> HealthGen <span class="sc">+</span> SleepHrsNight <span class="sc">+</span> SleepTrouble <span class="sc">+</span> PhysActive,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Depressed_data_imp,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(glm_depressed_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)               -0.69849750 0.24447519 -2.8571304 4.274902e-03
Gendermale                -0.35013436 0.06635730 -5.2765011 1.316737e-07
Poverty                   -0.14101155 0.02215839 -6.3637990 1.968237e-10
MaritalStatusLivePartner   0.03799677 0.13657028  0.2782214 7.808424e-01
MaritalStatusMarried      -0.69408720 0.10439187 -6.6488625 2.953667e-11
MaritalStatusNeverMarried -0.04071160 0.11492279 -0.3542517 7.231502e-01
MaritalStatusSeparated     0.26400573 0.19883883  1.3277373 1.842649e-01
MaritalStatusWidowed      -0.55903434 0.15483315 -3.6105598 3.055368e-04
HealthGenVgood             0.54530148 0.14490795  3.7630889 1.678275e-04
HealthGenGood              0.78398653 0.14108693  5.5567621 2.748249e-08
HealthGenFair              1.31921554 0.15292920  8.6263155 6.336007e-18
HealthGenPoor              1.99154402 0.21206863  9.3910354 5.941327e-21
SleepHrsNight             -0.08492945 0.02402668 -3.5347978 4.080873e-04
SleepTroubleYes            0.76186607 0.07014487 10.8613223 1.761794e-27
PhysActiveYes             -0.22955285 0.06853308 -3.3495188 8.095205e-04</code></pre>
</div>
</div>
</details>
<p>Do all variables <strong>contribute significantly</strong> to the quality of the model?</p>
<details>
<summary>
Show output
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(glm_depressed_2, <span class="at">test =</span> <span class="st">"Chisq"</span>)[ , <span class="st">"Pr(&gt;Chi)"</span>, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               Pr(&gt;Chi)    
&lt;none&gt;                     
Gender          1.2e-07 ***
Poverty       &lt; 2.2e-16 ***
MaritalStatus &lt; 2.2e-16 ***
HealthGen     &lt; 2.2e-16 ***
SleepHrsNight 0.0004055 ***
SleepTrouble  &lt; 2.2e-16 ***
PhysActive    0.0008100 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</details>
<p>All seven predictors showed significant χ² tests and thus contribute meaningfully to the model fit.</p>
</section>
<section id="model-3-removing-conceptually-collinear-predictor-healthgen" class="level3">
<h3 class="anchored" data-anchor-id="model-3-removing-conceptually-collinear-predictor-healthgen">Model 3: Removing conceptually collinear predictor (HealthGen)</h3>
<p><code>HealthGen</code> was removed in Model 3 because self-rated general health overlaps conceptually with depressive symptoms. Since the aim is interpretation rather than maximizing predictive accuracy, excluding <code>HealthGen</code> avoids this conceptual redundancy.</p>
<details>
<summary>
Show output
</summary>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>glm_depressed_3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Depressed_bin <span class="sc">~</span> Gender <span class="sc">+</span> Poverty <span class="sc">+</span> MaritalStatus <span class="sc">+</span> SleepHrsNight <span class="sc">+</span> SleepTrouble <span class="sc">+</span> PhysActive,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> Depressed_data_imp,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> binomial)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(glm_depressed_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Estimate Std. Error    z value     Pr(&gt;|z|)
(Intercept)                0.43470729 0.19717151  2.2047166 2.747399e-02
Gendermale                -0.31947182 0.06541468 -4.8837941 1.040637e-06
Poverty                   -0.19375858 0.02134380 -9.0779796 1.106089e-19
MaritalStatusLivePartner   0.04545715 0.13485745  0.3370756 7.360599e-01
MaritalStatusMarried      -0.65157649 0.10275190 -6.3412600 2.278936e-10
MaritalStatusNeverMarried -0.02514753 0.11340192 -0.2217557 8.245040e-01
MaritalStatusSeparated     0.26273383 0.19502771  1.3471616 1.779282e-01
MaritalStatusWidowed      -0.49070917 0.15158660 -3.2371539 1.207283e-03
SleepHrsNight             -0.11298655 0.02368400 -4.7705846 1.836920e-06
SleepTroubleYes            0.86175991 0.06868097 12.5472884 4.113568e-36
PhysActiveYes             -0.40577903 0.06594245 -6.1535327 7.577576e-10</code></pre>
</div>
</div>
</details>
<p>To evaluate the discriminatory power of this logistic regression model, a <strong>ROC (Receiver Operating Characteristic)</strong> analysis is performed using the pROC package.</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(glm_depressed_3<span class="sc">$</span>y, <span class="fu">fitted</span>(glm_depressed_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = glm_depressed_3$y, predictor = fitted(glm_depressed_3))

Data: fitted(glm_depressed_3) in 5058 controls (glm_depressed_3$y 0) &lt; 1379 cases (glm_depressed_3$y 1).
Area under the curve: 0.7059</code></pre>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ROC-Kurve plotten</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(glm_depressed_3<span class="sc">$</span>y, <span class="fu">fitted</span>(glm_depressed_3))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="glm-binomial_files/figure-html/GLM_Binomial_3_ROC-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>The AUC of 0.706 indicates that the model has a good discriminatory ability, correctly ranking depressed individuals above non-depressed individuals in about 71% of all case–control pairs.</p>
<section id="anova-comparing-glm-models-2-and-3" class="level4">
<h4 class="anchored" data-anchor-id="anova-comparing-glm-models-2-and-3">ANOVA: comparing GLM models 2 and 3</h4>
<p>As a <strong>preliminary check</strong>, an analysis of deviance (ANOVA) is being conducted to test whether <code>HealthGen</code> in model 2 significantly improves model fit compared to model 3.</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>anova_res <span class="ot">&lt;-</span> <span class="fu">anova</span>(glm_depressed_2, glm_depressed_3, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>delta_dev <span class="ot">&lt;-</span> anova_res<span class="sc">$</span>Deviance[<span class="dv">2</span>]     <span class="co"># Modell 3 vs. Modell 2</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>p_val     <span class="ot">&lt;-</span> anova_res<span class="sc">$</span><span class="st">`</span><span class="at">Pr(&gt;Chi)</span><span class="st">`</span>[<span class="dv">2</span>]   <span class="co"># p-Wert</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>delta_dev</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -146.4578</code></pre>
</div>
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>p_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.168622e-30</code></pre>
</div>
</div>
<p>Removing <code>HealthGen</code> worsened model fit substantially (ΔDeviance = 146.46, p &lt; 0.001), confirming its strong but conceptually overlapping contribution.</p>
</section>
<section id="akaike-information-criterion-aic" class="level4">
<h4 class="anchored" data-anchor-id="akaike-information-criterion-aic">Akaike Information Criterion (AIC)</h4>
<p>The AIC is a commonly used measure of model fit that balances model accuracy and complexity. It is chosen because it allows a direct <strong>comparison between models with different numbers of parameters</strong>, penalizing excessive complexity while rewarding better data fit.</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(glm_depressed_3, glm_depressed_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                df      AIC
glm_depressed_3 11 6117.234
glm_depressed_2 15 5978.776</code></pre>
</div>
</div>
<p>Model 2 (AIC = 5978.8) outperformed Model 3 (AIC = 6117.2), confirming the added explanatory value of <code>HealthGen</code>.</p>
</section>
</section>
<section id="confusion-matrix" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix">Confusion matrix</h3>
<p>We next assess the predictive performance of the models using confusion matrices.</p>
<p>Then we use the function to calculate these measures for the two models.</p>
<details>
<summary>
Show output
</summary>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>### GLM Model 2 (without Age and BMI) 
NULL

Accuracy: 0.792
Sensitivity: 0.151
Specificity: 0.967
Precision: 0.553</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>### GLM Model 3 (without Age, BMI, HealthGen) 
NULL

Accuracy: 0.786
Sensitivity: 0.094
Specificity: 0.975
Precision: 0.502</code></pre>
</div>
</div>
</details>
<section id="results-of-confusion-matrices" class="level4">
<h4 class="anchored" data-anchor-id="results-of-confusion-matrices">Results of Confusion Matrices</h4>
<p>Model 2 showed higher accuracy (0.79), sensitivity (0.15), and precision (0.55) than Model 3, confirming better predictive performance. This indicates that HealthGen substantially improves the model’s ability to correctly identify depressed individuals, even though it may not be conceptually independent from the outcome.</p>
</section>
<section id="optimal-classification-threshold" class="level4">
<h4 class="anchored" data-anchor-id="optimal-classification-threshold">Optimal classification threshold</h4>
<p>Because the default threshold of 0.5 yielded very low sensitivity, adjusting the classification threshold can be reasonable. Lowering the threshold typically increases the model’s ability to identify depressed individuals, which may be more important depending on the research goal. Here the optimal threshold is determined based on the ROC curve for <strong>model 3</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coords</span>(roc_obj, <span class="st">"best"</span>, <span class="at">ret =</span> <span class="fu">c</span>(<span class="st">"threshold"</span>, <span class="st">"sensitivity"</span>, <span class="st">"specificity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  threshold sensitivity specificity
1 0.2231247   0.6113125   0.6949387</code></pre>
</div>
</div>
<p>With the default threshold of 0.5, the model detects only 15% of depressed individuals, meaning that most true cases are misclassified as non-depressed. After lowering the threshold to 0.22, sensitivity increases to 61%, making the model substantially better at identifying depressed individuals.</p>
</section>
</section>
<section id="note-on-overdispersion" class="level3">
<h3 class="anchored" data-anchor-id="note-on-overdispersion">Note on Overdispersion</h3>
<p>Because <code>Depressed_bin</code> consists of individual Bernoulli observations (0/1), overdispersion is not an issue for this analysis.</p>
</section>
<section id="final-remark-on-model-selection" class="level3">
<h3 class="anchored" data-anchor-id="final-remark-on-model-selection">Final remark on model selection</h3>
<p>Model 2, which includes <code>HealthGen</code>, provides the best statistical fit and is preferable for prediction. Model 3, which excludes <code>HealthGen</code>, yields a less optimal fit but offers clearer interpretability of the other predictors. Therefore, <strong>Model 2</strong> is suited for predictive purposes, whereas <strong>Model 3</strong> is more appropriate for understanding how socioeconomic and lifestyle factors relate to depressive symptoms.</p>
</section>
<section id="research-questions-answered" class="level3">
<h3 class="anchored" data-anchor-id="research-questions-answered">Research questions answered</h3>
<ol type="1">
<li><p><strong>Key predictors of depression</strong>: Gender, poverty, marital status, general health, sleep duration, sleep trouble, and physical activity were significantly related to depressive symptoms, whereas age and BMI showed no meaningful effects.</p></li>
<li><p><strong>Effects of removing predictors</strong>: Dropping non-significant variables improved interpretability, but removing HealthGen greatly worsened model fit. Thus, the model including HealthGen performs best statistically, while the reduced model offers clearer interpretation.</p></li>
<li><p><strong>Model discrimination and threshold</strong>: The model showed moderate discrimination (AUC ≈ 0.71). Lowering the classification threshold from 0.5 to 0.22 substantially improved sensitivity, making it more effective at identifying depressed individuals.</p></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>
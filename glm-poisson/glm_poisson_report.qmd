---
title: "Statistical Analysis of Daily Alcohol Consumption Factors"
subtitle: "Generalized Linear Model - Poisson Regression Analysis"
format: 
  html:
    toc: true
    toc-depth: 2
    code-fold: true
    page-layout: full
    grid:
      margin-width: 250px
    theme: cosmo
execute:
  warning: false
  message: false
---

::: {.callout-note collapse=true title="See key findings"}
## Key Findings

**Demographic Factors:**

-   Men consume **37.8% more alcohol** daily than women
-   College graduates drink **38% less** than those with 8th grade education
-   Each additional year of age reduces consumption by **1.53%**

**Health Indicators:**

-   Individuals feeling depressed "Most" days drink **44.6% less**
-   Each additional hour of sleep reduces consumption by **3.8%**
-   Higher systolic blood pressure correlates with increased consumption (**0.26% per unit**)

**Socioeconomic Impact:**

-   Higher poverty index (greater wealth) associated with **3.5% less** daily consumption

**Statistical Confidence:** All findings significant at p \< 0.05 level (n=2,318 observations)
:::

# Background & Objectives

Alcohol consumption is attributed as a major risk factor for many diseases. For example, according the the [National Institute on Alcohol Abuse and Alcoholism](https://www.niaaa.nih.gov/alcohols-effects-health/alcohols-effects-body), women that drink alcohol have 5 to 15% chance more of getting breast cancer. Moreover, in Europe in 2020, alcohol consumption can be attributed to the death of 3.6 people per 100'000 ([Eurostat](https://ec.europa.eu/eurostat/web/products-eurostat-news/w/ddn-20231010-1)). As such, the effect of alcohol consumption on society is tremendous, prompting the need of a better understanding of its predictors. This analysis investigates the relationship between daily alcohol consumption and physical/mental health indicators using NHANES data. The primary objective is to identify significant predictors of alcohol consumption patterns to inform health intervention strategies, and enable targetted prevention measures.

Our objective it to investigate whether there is a measurable link between daily alcohol consumption and physical/mental health indicators.

# Methodology

:::: {.columns}
::: {.column}
## Data & Sample

```{r}
library(readr)
library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
library(mgcv)
library(multcomp)
library(plotly)

nhanes <- readRDS(here("nhanes.rds"))

nhanes <- nhanes %>%
  mutate(
    Gender = as.factor(Gender),
    AgeDecade = as.factor(AgeDecade),
    Race1 = as.factor(Race1),
    Education = as.factor(Education),
    MaritalStatus = as.factor(MaritalStatus),
    HHIncome = as.factor(HHIncome),
    HealthGen = as.factor(HealthGen),
    PhysActive = as.factor(PhysActive),
    SleepTrouble = as.factor(SleepTrouble),
    Alcohol12PlusYr = as.factor(Alcohol12PlusYr),
    SmokeNow = as.factor(SmokeNow),
    Smoke100 = as.factor(Smoke100),
    LittleInterest = as.factor(LittleInterest),
    Depressed = as.factor(Depressed)
  )
```

Our outcome variable is `AlcoholDay`; the daily number of alcoholic drinks (Poisson-distributed count data)

The predictors we have at our disposal can be classified into the following categories.

-   Physical Health: Weight, systolic blood pressure (BPSysAve), physical activity days, sleep hours
-   Mental Health: Depression frequency, days with poor mental health
-   Demographics: Gender, age, education, poverty index, survey year
:::
::: {.column}

## Statistical Approach

The solve our research question, we chose a Generalized Linear Model with Poisson family distribution, appropriate for count data with discrete outcomes. While non-linear models (GAM) might capture relationships better, the GLM provides superior interpretability for actionable insights—critical for health policy decisions.

## Data Cleaning Strategy

```{r}
model_nhanes <- nhanes %>%
  dplyr::select(AlcoholDay, Weight, BPSysAve, PhysActiveDays, SleepHrsNight, 
                Depressed, DaysMentHlthBad, Education, Poverty, Gender, SurveyYr, Age) %>%
  drop_na()

cat("Final sample size:", nrow(model_nhanes), "observations (2,318 complete cases)")
```

The data had a lot missing values. To ensure having as much complete observations as possible, we selected the most promising factors, focusing on validity of measurements. As such, subjective measurements such as surveys were not retained. After cleaning, our data contains 2,318 complete observations—sufficient for robust linear modeling.

:::
::::

# Results

## Outcome Distribution

::: {layout-ncol="2"}
```{r}
#| fig-width: 4
#| fig-height: 3
ggplot(data = nhanes, mapping = aes(x = AlcoholDay)) +
  geom_histogram(aes(y = ..density..), color = "blue", fill = "blue", alpha=0.3, bins=30) +
  ggtitle("Daily Alcohol Consumption Distribution") +
  theme_minimal()
```

```{r}
nhanes %>%
  summarize(
    Mean = round(mean(AlcoholDay, na.rm = T), 2),
    Median = median(AlcoholDay, na.rm = T),
    SD = round(sd(AlcoholDay, na.rm = T), 2),
    Q1 = quantile(AlcoholDay, 0.25, na.rm = T),
    Q3 = quantile(AlcoholDay, 0.75, na.rm = T)
  ) %>%
  knitr::kable(caption = "Descriptive Statistics")
```
:::

The outcome follows a Poisson distribution with median of 2 drinks/day and high variability, typical of alcohol consumption patterns.

## Model Fit & Significant Predictors

::: {.callout-note collapse="true" title="See full statistical output"}
```{r}
model <- glm(formula = AlcoholDay ~ Weight + BPSysAve + PhysActiveDays + SleepHrsNight + 
             Depressed + DaysMentHlthBad + Education + Poverty + Gender + SurveyYr + Age, 
             family = "poisson", data = model_nhanes)
summary(model)
```
:::

**Mental Health:** According to the model, we found strong evidence at the 5% level under the null hypothesis that the difference in intercept in alcohol consumption between people feeling depressed *most* or *several* day of the past 2 weeks compared to people not feeling depressed, is, on average significantly different from 0. More specificialy, people rating that they felt depressed *Several* days for the past 2 weeks, drink on average 13.4% less than people rating *None*, while people rating 'Most' drink on average 44.6% less than people rating *None*.

**Demographics:** We also found strong evidence at the 5% level under the null hypothesis that the difference in intercept in alcohol consumption between male and female, is, on average, significantly different from 0. More specifically, on average, men drink 37.8% more than women. Additionnaly, we observe similar evidence between 'College Grad' & 'Some College' compared to '8th Grade' education level. People having having a college degree drink on average 38% less than people having an education stopping at the 8th grade, while people who went to college drink on average 20% less. Similarly, we found strong evidence at the 5% level under the null hypothesis that the coefficients of `Age` is, on average, significantly different from 0. More specifically, considering all other variable constant, a increase of one year in age implies on average a decrease of daily alcohol consumption by 1.53%. Lastly, we found strong evidence at the 5% level under the null hypothesis the the coefficient of `Poverty` is significantly different from 0 on average. More specifically, all other variables constant, an increase of one unit in the poverty index decrease daily alcohol consumption by 3.5%.

**Physical Health:** We found strong evidence at the 5% significance level under the null hypothesis that the coefficients of `SleepHrsNight` & `BPSysAve`s, on average, significantly different from 0. Considering all other variables constant, an increase of one hour slept per night decrease daily alcohol consumption by 3.8% on average.

## Model Validation

::: {.callout-note collapse="true" title="See education-level contrast analysis output"}
```{r}
levels(model_nhanes$Education) <- c("8thGrade", "9-11thGrade", "HighSchool", "SomeCollege", "CollegeGrad")

glht_model <- glm(formula = AlcoholDay ~ Weight + BPSysAve + PhysActiveDays + SleepHrsNight + 
                  Depressed + DaysMentHlthBad + Education + Poverty + Gender + SurveyYr + Age, 
                  family = "poisson", data = model_nhanes)

summary(glht(model = glht_model, linfct = mcp(Education = c("CollegeGrad - SomeCollege = 0"))))
```
:::

Additional analysis confirms that college graduates and some-college individuals differ significantly in consumption levels (p \< 0.05).

::: {.callout-note collapse="true" title="See depression-level contrast analysis output"}
```{r}
summary(glht(model = glht_model, linfct = mcp(Depressed = c("Several - Most = 0"))))
```
:::

Moreover, consumption patterns differ significantly between "Several" and "Most" days depressed (p \< 0.05).

::: {.callout-note collapse="true" title="See single-term deletion statistical output"}
```{r}
drop1(model, test="F")
```
:::

Finally, all identified significant predictors produce substantial changes in model fit when removed, confirming their importance.

## Predictive Performance

:::: {.columns}
::: {.column}
While the model provides strong statistical inference, prediction accuracy is very imited. Indeed, the model is, on average off by 60 drink a day (MAE ≈ 60). Naturally, this doesn't diminish the validit yof the effects found, it only highlights that this model is designed for **understanding relationships**, not forecasting individual consumption.

```{r}
rmse <- function(y, y_pred) sqrt(mean((y - y_pred)^2))
mae <- function(y, y_pred) mean(abs(y - y_pred))

cat("RMSE:", round(rmse(model_nhanes$AlcoholDay, exp(model$fitted.values)), 2), "\n")
cat("MAE:", round(mae(model_nhanes$AlcoholDay, exp(model$fitted.values)), 2))
```
:::
::: {.column style="padding: 10px;"}
```{r}
#| fig-width: 5
#| fig-height: 3
p <- ggplot(data = model_nhanes, 
       mapping = aes(x = AlcoholDay, y = exp(as.vector(model$residuals)))) +
  geom_point(color = "blue", alpha = 0.3) +
  labs(y = "Residuals", x = "AlcoholDay", title = "Residual Plot") +
  theme_minimal()
ggplotly(p)
```
:::
::::

# Strategic Implications

The previous findings provide useful insights for a better prevention targetted on the right demographics, such as males, younger adults, and lower education groups. Promoting healthy sleep patterns could be explored to reduce alcohol consumptions. Additionnaly, lower-income population show higher consumption. Social determinants matter!

Our findings also brings insights for the clinical practice,

-   **Blood Pressure Monitoring:** Bidirectional relationship warrants careful monitoring in patients with elevated consumption
-   **Education-Based Outreach:** Tailor messaging to education levels for maximum impact
-   **Holistic Assessment:** Physical and mental health indicators jointly influence consumption patterns

## Limitations

With all things considers, the analysis has severaly limits. Firstly, the model has been designed for inference and has poor forecasting accuracy. Although we retained more than 2000 observation, the deletion of 75% of the data my have introduce a selection bias. As self-reported measures, depression and other health variables are subject to reporting biases.

# Conclusion

This analysis provides robust statistical evidence that daily alcohol consumption is significantly influenced by demographic factors (gender, age, education), mental health indicators (depression), lifestyle factors (sleep duration), and socioeconomic status (poverty index). The findings are usefull in supporting targeted intervention strategies that address both individual risk factors and social determinants of health.

To go further, developing predictive modeling capabilities is crucial in order to identify high-risk individuals for early intervention.